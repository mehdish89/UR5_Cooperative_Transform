from math import *
import numpy as np

def forward(q):

	d1 =  0.089159
	a2 = -0.42500
	a3 = -0.39225
	d4 =  0.10915
	d5 =  0.09465
	d6 =  0.0823

	#print(q)

	q1 = q[0]
	q2 = q[1]
	q3 = q[2]
	q4 = q[3]
	q5 = q[4]
	q6 = q[5]

	s1 = sin(q1) 
	c1 = cos(q1)

	q234 = q2+q3+q4 
	s2 = sin(q2)
	c2 = cos(q2)
	s3 = sin(q3)
	c3 = cos(q3)
	s5 = sin(q5)
	c5 = cos(q5)
	s6 = sin(q6)
	c6 = cos(q6) 
	s234 = sin(q234)
	c234 = cos(q234)

	nx = ((c1*c234-s1*s234)*s5)/2.0 - c5*s1 + ((c1*c234+s1*s234)*s5)/2.0

	ox = (c6*(s1*s5 + ((c1*c234-s1*s234)*c5)/2.0 + ((c1*c234+s1*s234)*c5)/2.0) - 
		      (s6*((s1*c234+c1*s234) - (s1*c234-c1*s234)))/2.0)
		      
	ax = (-(c6*((s1*c234+c1*s234) - (s1*c234-c1*s234)))/2.0 - 
		      s6*(s1*s5 + ((c1*c234-s1*s234)*c5)/2.0 + ((c1*c234+s1*s234)*c5)/2.0))
		      
	px = ((d5*(s1*c234-c1*s234))/2.0 - (d5*(s1*c234+c1*s234))/2.0 - 
		      d4*s1 + (d6*(c1*c234-s1*s234)*s5)/2.0 + (d6*(c1*c234+s1*s234)*s5)/2.0 - 
		      a2*c1*c2 - d6*c5*s1 - a3*c1*c2*c3 + a3*c1*s2*s3)        
		      
	ny = c1*c5 + ((s1*c234+c1*s234)*s5)/2.0 + ((s1*c234-c1*s234)*s5)/2.0

	oy = (c6*(((s1*c234+c1*s234)*c5)/2.0 - c1*s5 + ((s1*c234-c1*s234)*c5)/2.0) + 
		      s6*((c1*c234-s1*s234)/2.0 - (c1*c234+s1*s234)/2.0))
		      
	ay = (c6*((c1*c234-s1*s234)/2.0 - (c1*c234+s1*s234)/2.0) - 
		      s6*(((s1*c234+c1*s234)*c5)/2.0 - c1*s5 + ((s1*c234-c1*s234)*c5)/2.0))          
		      
	py = ((d5*(c1*c234-s1*s234))/2.0 - (d5*(c1*c234+s1*s234))/2.0 + d4*c1 + 
		      (d6*(s1*c234+c1*s234)*s5)/2.0 + (d6*(s1*c234-c1*s234)*s5)/2.0 + d6*c1*c5 - 
		      a2*c2*s1 - a3*c2*c3*s1 + a3*s1*s2*s3)
		      
	nz = ((c234*c5-s234*s5)/2.0 - (c234*c5+s234*s5)/2.0)

	oz = ((s234*c6-c234*s6)/2.0 - (s234*c6+c234*s6)/2.0 - s234*c5*c6)

	az = (s234*c5*s6 - (c234*c6+s234*s6)/2.0 - (c234*c6-s234*s6)/2.0)

	pz = (d1 + (d6*(c234*c5-s234*s5))/2.0 + a3*(s2*c3+c2*s3) + a2*s2 - 
		     (d6*(c234*c5+s234*s5))/2.0 - d5*c234)

	return np.array([[nx, ox, ax, px],
					[ny, oy, ay, py],
					[nz, oz, az, pz],						
					[0, 0, 0, 1]])
